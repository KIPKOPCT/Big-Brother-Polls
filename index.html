<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BBMS6 Live Polls</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: Arial, Helvetica, sans-serif;
        }

        body {
            margin: 0;
            background: radial-gradient(circle at center, #0b1a3a, #020816);
            color: white;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 40px;
            gap: 1rem;
        }

        .header h1 {
            margin: 0;
        }

        .header-notes {
            font-size: 16px;
        }

        .logo-box {
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0.7;
        }

        .logo-box img {
            width: 100px;
        }

        .poll-section {
            position: relative;
            padding: 40px;
        }

        .poll-section::before {
            content: "";
            position: absolute;
            inset: 0;
            background: radial-gradient(circle, transparent 55%, rgba(255,255,255,0.1) 56%, transparent 57%),
                        radial-gradient(circle, transparent 70%, rgba(255,255,255,0.08) 71%, transparent 72%);
            pointer-events: none;
        }

        .poll-title {
            text-align: center;
            margin-bottom: 40px;
        }

        .chart-area {
            display: flex;
        }

        .y-axis {
            width: 60px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            text-align: right;
            padding-right: 10px;
        }

        .y-axis span {
            opacity: 0.7;
        }

        .chart {
            flex: 1;
            position: relative;
            height: 400px;
            border-left: 2px solid white;
            border-bottom: 2px solid white;
        }

        .line {
            position: absolute;
            left: 0;
            right: 0;
            height: 1px;
            background: rgba(255,255,255,0.3);
        }

        .line.l40 { top: 0%; }
        .line.l30 { top: 25%; }
        .line.l20 { top: 50%; }
        .line.l10 { top: 75%; }

        .scroll-chart {
            overflow-x: auto;
            overflow-y: hidden;
            position: relative;
            height: 400px;
        }

        .scroll-chart::-webkit-scrollbar {
            height: 8px;
        }

        .scroll-chart::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.4);
            border-radius: 10px;
        }

        .scroll-chart::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
        }

        .bars-container {
            display: flex;
            justify-content: space-around;
            align-items: flex-end;
            height: 100%;
            min-width: 1400px;
            padding: 0 20px;
            gap: 15px;
            position: relative;
            z-index: 10;
        }

        .bar-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            width: 90px;
            flex-shrink: 0;
        }

        .bar {
            width: 60px;
            height: 0;
            background: linear-gradient(to top, #19ff00, #ffe600);
            border-radius: 6px 6px 0 0;
            transition: height 0.5s ease;
            margin: 5px 0;
            box-shadow: 0 0 20px rgba(255, 230, 0, 0.3);
        }

        .percent {
            margin-bottom: 8px;
            font-weight: bold;
            color: #fff;
            font-size: 14px;
        }

        .bar-wrapper > div:nth-child(3) {
            font-size: 12px;
            font-weight: 600;
            margin: 5px 0;
            color: #fff;
            max-width: 80px;
            word-wrap: break-word;
        }

        .vote-btn {
            margin-top: 8px;
            padding: 8px 16px;
            border-radius: 20px;
            border: none;
            cursor: pointer;
            background: linear-gradient(45deg, #c2187a, #7b1fa2);
            color: white;
            font-weight: bold;
            font-size: 12px;
            transition: transform 0.2s;
        }

        .vote-btn:hover {
            transform: translateY(-2px);
        }

        .vote-btn:disabled {
            background: gray;
            transform: none;
            cursor: not-allowed;
        }

        .housemates {
            padding: 50px 40px;
        }

        .housemates h2 {
            margin-bottom: 30px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
        }

        .card {
            background: linear-gradient(to top, #c2187a, #7b1fa2);
            border-radius: 16px;
            overflow: hidden;
        }

        .card img {
            width: 100%;
            height: 240px;
            object-fit: cover;
        }

        .card-name {
            padding: 12px;
            text-align: center;
            font-weight: bold;
        }

        footer {
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
        }

        footer p span {
            color: #7b1fa2;
        }
    </style>
</head>
<body>

<!-- HEADER -->
<div class="header">
    <div class="header-all">
        <h1>HOW OUR VIEWERS VOTED</h1>
        <p class="header-notes">
            See who is going to be evicted this week based on viewer votes! The results are in and the contestant with the lowest votes faces elimination. Stay tuned to find out which fan favourite will be leaving the competition in this week's dramatic eviction ceremony.
        </p>
    </div>
    <div class="logo-box">
        <img src="Images/300ppi/Big Brother KG Logo.png" alt="Logo">
    </div>
</div>

<!-- POLL -->
<section class="poll-section">
    <div class="poll-title">
        <p>Voting Percentage of Bottom 8</p>
    </div>

    <div class="chart-area">
        <!-- Y AXIS -->
        <div class="y-axis">
            <span>40%</span>
            <span>30%</span>
            <span>20%</span>
            <span>10%</span>
            <span>0%</span>
        </div>

        <!-- CHART -->
        <div class="chart scroll-chart">
            <div class="line l40"></div>
            <div class="line l30"></div>
            <div class="line l20"></div>
            <div class="line l10"></div>
            
            <!-- Bars will be inserted here by JavaScript -->
            <div class="bars-container" id="bars-container"></div>
        </div>
    </div>
</section>

<!-- HOUSEMATES -->
<section class="housemates">
    <h2>Meet the Housemates</h2>
    <div class="grid">
        <div class="card">
            <img src="images/1767954918_Liema_300 x 300.jpg" alt="">
            <div class="card-name">Buhle B</div>
        </div>
        <div class="card">
            <img src="images/1767957369_Thandeka_300 x 300.jpg" alt="">
            <div class="card-name">Kokii</div>
        </div>
        <div class="card">
            <img src="images/1767960889-55_Mshefane.webp" alt="">
            <div class="card-name">Mshefane</div>
        </div>
        <div class="card">
            <img src="images/1767960889-55_Mshefane.webp" alt="">
            <div class="card-name">Mshefane</div>
        </div>
        <div class="card">
            <img src="images/1767960889-55_Mshefane.webp" alt="">
            <div class="card-name">Mshefane</div>
        </div>
        <div class="card">
            <img src="images/1767960889-55_Mshefane.webp" alt="">
            <div class="card-name">Mshefane</div>
        </div>
        <div class="card">
            <img src="images/1767960889-55_Mshefane.webp" alt="">
            <div class="card-name">Mshefane</div>
        </div>
        <div class="card">
            <img src="images/1767960889-55_Mshefane.webp" alt="">
            <div class="card-name">Mshefane</div>
        </div>
        <div class="card">
            <img src="images/1767960889-55_Mshefane.webp" alt="">
            <div class="card-name">Mshefane</div>
        </div>
        <div class="card">
            <img src="images/1767960889-55_Mshefane.webp" alt="">
            <div class="card-name">Mshefane</div>
        </div>
        <div class="card">
            <img src="images/1767960889-55_Mshefane.webp" alt="">
            <div class="card-name">Mshefane</div>
        </div>
        <div class="card">
            <img src="images/1767960889-55_Mshefane.webp" alt="">
            <div class="card-name">Mshefane</div>
        </div>
    </div>
</section>

<footer>
    <div class="footer">
        <p>This is a live prediction poll where website visitors like you can vote for who you think will be evicted this week. Based on real-time votes from our online community, these results show which contestants our readers believe are most likely to exit the competition in the upcoming eviction.</p>
        <p>Live voting results • Data updates in real-time • Developed by <span>Kipkop graphics</span></p>
        <p>© 2026 Poll Display System • All percentages are final</p>
    </div>
</footer>

<script>
    const contestants = [
        { id: "ashay", label: "ASHAY" },
        { id: "bravo", label: "BRAVO B" },
        { id: "didi", label: "DIDI" },
        { id: "dube", label: "DUBE" },
        { id: "ilano", label: "ILANO" },
        { id: "wanda", label: "KING WANDA" },
        { id: "liema", label: "LIEMA" },
        { id: "neliswa", label: "NELISWA" },
        { id: "que", label: "QUE" },
        { id: "ramona", label: "RAMONA" },
        { id: "thandeka", label: "THANDEKA" },
        { id: "thedon", label: "THE DON" },
        { id: "trixie", label: "TRIXIE" },
        { id: "tumi", label: "TUMI THE" }
    ];

    const MAX_VOTES = 500;
    const VOTE_COST = 100;

    // Initialize votes in localStorage if not exists
    if (!localStorage.getItem('pollVotes')) {
        const initialVotes = {};
        contestants.forEach(c => {
            initialVotes[c.id] = Math.floor(Math.random() * 50) + 10; // Random between 10-60
        });
        localStorage.setItem('pollVotes', JSON.stringify(initialVotes));
    }

    function todayKey() {
        return new Date().toISOString().split("T")[0];
    }

    function canVote() {
        const today = todayKey();
        if (localStorage.getItem("voteDay") !== today) {
            localStorage.setItem("voteDay", today);
            localStorage.setItem("voteBalance", MAX_VOTES);
        }
        return Number(localStorage.getItem("voteBalance")) >= VOTE_COST;
    }

    function useVote() {
        const b = Number(localStorage.getItem("voteBalance"));
        localStorage.setItem("voteBalance", b - VOTE_COST);
    }

    function getVotes() {
        const votes = localStorage.getItem('pollVotes');
        return votes ? JSON.parse(votes) : {};
    }

    function saveVotes(votes) {
        localStorage.setItem('pollVotes', JSON.stringify(votes));
    }

    function renderBars() {
        const barsContainer = document.getElementById("bars-container");
        if (!barsContainer) return;
        
        barsContainer.innerHTML = "";

        const votes = getVotes();
        const total = Object.values(votes).reduce((a, b) => a + b, 0) || 1;

        // Sort contestants by votes (highest first)
        const sorted = [...contestants].sort(
            (a, b) => (votes[b.id] || 0) - (votes[a.id] || 0)
        );

        sorted.forEach((c) => {
            const value = votes[c.id] || 0;
            const percent = ((value / total) * 100).toFixed(1);
            // Scale bar height (max 200px)
            const barHeight = Math.max(10, (percent * 2));

            const barWrapper = document.createElement('div');
            barWrapper.className = 'bar-wrapper';
            barWrapper.innerHTML = `
                <div class="percent">${percent}%</div>
                <div class="bar" style="height: ${barHeight}px;"></div>
                <div>${c.label}</div>
                <button class="vote-btn" onclick="vote('${c.id}')">Vote</button>
            `;
            
            barsContainer.appendChild(barWrapper);
        });
    }

    window.vote = async function(id) {
        if (!canVote()) {
            alert("You have used all your votes today. Come back tomorrow!");
            return;
        }

        useVote();
        
        // Update votes
        const votes = getVotes();
        votes[id] = (votes[id] || 0) + 1;
        saveVotes(votes);
        
        // Show remaining votes
        const remaining = localStorage.getItem("voteBalance");
        alert(`Voted for ${id}! You have ${remaining} votes remaining today.`);
        
        // Re-render bars
        renderBars();
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', () => {
        renderBars();
        
        // Refresh every 5 seconds
        setInterval(() => {
            renderBars();
        }, 5000);
    });
</script>
<script src="api/results.js"></script>
<script src="api/votes.js"></script>

</body>
</html>